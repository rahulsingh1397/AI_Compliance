{% extends "base.html" %}

{% block title %}{{ gettext('Dashboard') }} - {{ super() }}{% endblock %}

{% block content %}
    <!-- Main Header -->
    <div class="main-header">
        <div class="search-bar">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Search for alerts, files, or reports...">
        </div>
        <div class="header-actions">
            <button class="header-icon-btn"><i class="far fa-bell"></i></button>
            <div class="header-date" id="current-date"></div>
            <button id="run-scan-btn" class="btn btn-primary me-2"><i class="fas fa-search me-1"></i>{{ gettext('Run Scan') }}</button>
            <button id="create-report-btn" class="btn create-btn">{{ gettext('Create Report') }}</button>
        </div>
    </div>

    <!-- Page Title -->
    <h1 class="page-title">{{ gettext('Dashboard') }}</h1>

    <!-- Key Metrics Row -->
    <div class="row">
        <div class="col-md-3 mb-4 mb-md-0">
            <a href="{{ url_for('dashboard.sensitive_files') }}" class="stat-card-link">
                <div class="stat-card card-hover h-100">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-file-excel me-2"></i>{{ gettext('Sensitive Files') }}</h5>
                        <p class="card-text" id="sensitive-files-count">-</p>
                        <div class="card-footer-text">Across all sources</div>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-md-3 mb-4 mb-md-0">
            <a href="{{ url_for('dashboard.scans') }}" class="stat-card-link">
                <div class="stat-card card-hover h-100">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-search me-2"></i>{{ gettext('Total Scans') }}</h5>
                        <p class="card-text" id="total-scans-count">-</p>
                        <div class="card-footer-text">Last 30 days</div>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-md-3 mb-4 mb-md-0">
            <a href="{{ url_for('dashboard.risk_overview') }}" class="stat-card-link">
                <div class="stat-card card-hover h-100">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-exclamation-triangle me-2"></i>{{ gettext('Risk Level') }}</h5>
                        <p class="card-text" id="risk-level-status">-</p>
                        <div class="card-footer-text">Overall assessment</div>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-md-3 mb-4 mb-md-0">
            <a href="{{ url_for('dashboard.scans') }}" class="text-decoration-none">
                <div class="stat-card card-hover">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-calendar-alt me-2"></i>{{ gettext('Last Scan') }}</h5>
                        <p class="card-text" id="last-scan-date">-</p>

                    </div>
                </div>
            </a>
        </div>
    </div>

    <!-- Charts Row -->
    <div class="row mt-4">
        <div class="col-lg-6 mb-4">
            <div class="chart-wrapper">
                <div class="list-header">
                    <h4><i class="fas fa-chart-pie me-2"></i>{{ gettext('Sensitive Data Types') }}</h4>
                    <a href="{{ url_for('dashboard.data_types') }}" class="btn list-action-btn">{{ gettext('View All') }}</a>
                </div>
                <div class="chart-body">
                    <canvas id="dataTypesChart"></canvas>
                </div>
            </div>
        </div>
        <div class="col-lg-6 mb-4">
            <div class="chart-wrapper">
                <div class="list-header">
                    <h4><i class="fas fa-balance-scale me-2"></i>{{ gettext('Compliance Status') }}</h4>
                    <a href="{{ url_for('dashboard.compliance_status') }}" class="btn list-action-btn">{{ gettext('View All') }}</a>
                </div>
                <div class="chart-body">
                    <canvas id="complianceStatusChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Alerts List -->
    <div class="content-list-wrapper">
        <div class="list-header">
            <h4>{{ gettext('Recent Alerts') }}</h4>
            <div class="list-actions">
                <button class="btn list-action-btn"><i class="fas fa-filter me-1"></i> {{ gettext('Filter') }}</button>
                <button class="btn list-action-btn"><i class="fas fa-sort me-1"></i> {{ gettext('Sort') }}</button>
            </div>
        </div>
        <div class="list-content">
            <table class="alerts-list-table" id="alerts-table">
                <thead>
                    <tr>
                        <th>{{ gettext('Description') }}</th>
                        <th>{{ gettext('Severity') }}</th>
                        <th>{{ gettext('Timestamp') }}</th>
                        <th>{{ gettext('Source') }}</th>
                        <th>{{ gettext('Status') }}</th>
                        <th>&nbsp;</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Alert rows will be populated by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}
